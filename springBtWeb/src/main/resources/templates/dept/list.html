<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{/dept/default_layout}">

<div layout:fragment="content">
    <h1>부서목록</h1>

    <table border="1" class="table table-striped table-hover">
        <thead>
        <tr>
            <th>부서번호</th>
            <th>부서명</th>
            <th>부서위치</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="dept : ${deptList}">
            <td th:text="${dept.deptNo}"></td>
            <td><a th:text="${dept.dName}" th:href="@{/dept/list/{id}(id=${dept.deptNo},)}"></a></td>
            <td th:text="${dept.loc}"></td>
        </tr>
        </tbody>
    </table>

    [[ ${message} ]]

    <div>
        <form th:action="@{/dept/insert}" method="post" id="frmForm" th:object="${dept}">
            <ul>
                <li>
                    <label>부서번호:</label>
                    <input type="number" th:field="*{deptNo}" min="0" max="100" step="10" required>
                </li>
                <li>
                    <label>부서명:</label>
                    <input type="text" th:field="*{dName}" maxlength="14" required>
                </li>
                <li>
                    <label>위치:</label>
                    <input type="text" th:field="*{loc}" maxlength="13" required>
                </li>
            </ul>
            <!-- 한 폼에 submit 버튼은 1개만 두고, 나머지는 type="button"으로 분리 -->
            <button type="submit" class="btn btn-primary" id="btnNew">신규등록</button>
            <button type="submit" class="btn btn-warning" id="btnUpdate">수정저장</button>
            <button type="submit" class="btn btn-danger" id="btnDelete">삭제</button>
            <button type="submit" class="btn btn-secondary" id="btnReset">초기화</button>
        </form>
    </div>
</div>

<div layout:fragment="script">
    <script th:inline="javascript">

        $(function () {

          $('#frmForm').on('submit', function (e) {

           // alert('submit 이벤트가 발생되었습니다.');
            e.preventDefault(); // 이벤트 진행 중단
            const url = {
                'btnNew':'/dept/insert',
                'btnUpdate':'/dept/update',
                'btnDelete':'/dept/delete',
            };

            console.log(url['btnUpdate'], url.btnUpdate);

            const btn = event.submitter.id;
            console.log(url[btn]);

            $(this).attr({'action':url[btn]}).unbind('submit').submit();


          });

          // 마우스포인터가 버튼에 들어가면 '포인터가 들어왔습니다.', 나가면 '마우스가 나갔습니다.'
          $('#btnReset').on('click', function () {
            // console.log('초기화 버튼이 클릭되었습니다.');
            location.href="/dept/list";
            }).on('mouseenter', function () {
            console.log('마우스가 들어왔습니다!');
            }).on('mouseleave', function () {
            console.log('마우스가 나갔습니다!');});

 });
    </script>
</div>
</html>